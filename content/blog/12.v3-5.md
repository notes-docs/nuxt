---
title: 'Nuxt 3.5'
description: "Nuxt 3.5.0 ç°å·²å‘å¸ƒï¼Œå¸¦æ¥äº† Vue 3.3ã€æ–°çš„é»˜è®¤è®¾ç½®ã€äº¤äº’å¼æœåŠ¡å™¨ç»„ä»¶ã€ç±»å‹åŒ–é¡µé¢ã€ç¯å¢ƒé…ç½®ç­‰ç­‰ã€‚"
image: /assets/blog/v3-5.png
authors:
  - name: Daniel Roe
    avatar:
      src: https://github.com/danielroe.png
    to: https://bsky.app/profile/danielroe.dev
date: 2023-05-16
category: Release
---

## âš¡ï¸ Vue 3.3 å‘å¸ƒ

Vue 3.3 å·²ç»å‘å¸ƒï¼Œå¸¦æ¥äº†è®¸å¤šä»¤äººå…´å¥‹çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ç±»å‹æ”¯æŒæ–¹é¢ã€‚

* æ–°çš„ `defineOptions` å®
* â€œæ³›å‹â€ç»„ä»¶
* ç±»å‹åŒ–çš„æ’æ§½ä»¥åŠåœ¨ defineProps ä¸­ä½¿ç”¨å¤–éƒ¨ç±»å‹
* ...ç­‰ç­‰

è¿™è¿˜å¾—ç›Šäº [@antfu](https://github.com/antfu) å’Œ [@baiwusanyu-c](https://github.com/baiwusanyu-c) çš„è´¡çŒ®ï¼Œæå¤§åœ°æ”¹è¿›äº†åœ¨åµŒå¥—é¡µé¢ä¹‹é—´å¯¼èˆªæ—¶çš„æ•°æ®è·å– ([#20777](https://github.com/nuxt/nuxt/pull/20777))ã€‚

é˜…è¯» **[å®Œæ•´çš„å‘å¸ƒå…¬å‘Š](https://blog.vuejs.org/posts/vue-3-3)** ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

### ğŸ™Œ Nitropack v2.4

æˆ‘ä»¬ä¸€ç›´åœ¨åŠªåŠ›æ”¹è¿› Nitroï¼Œè¿™äº›æ”¹è¿›å·²ç»è½åœ°åœ¨ Nitro v2.4 ä¸­ - æ‚¨å¯èƒ½å·²ç»æ‹¥æœ‰æ­¤å‡çº§ï¼Œå…¶ä¸­åŒ…å«è®¸å¤šé”™è¯¯ä¿®å¤ã€Cloudflare çš„æ¨¡å— worker æ ¼å¼æ›´æ–°ã€Vercel KV æ”¯æŒç­‰ç­‰ã€‚

è¯·æ³¨æ„ï¼šå¦‚æœæ‚¨è¦éƒ¨ç½²åˆ° Vercel æˆ– Netlify å¹¶å¸Œæœ›å—ç›Šäºå¢é‡é™æ€å†ç”Ÿï¼Œæ‚¨ç°åœ¨åº”è¯¥æ›´æ–°æ‚¨çš„è·¯ç”±è§„åˆ™ï¼š

```diff
routeRules: {
--  '/blog/**': { swr: 3000 },
++  '/blog/**': { isr: 3000 },
}
```

é˜…è¯» **[å®Œæ•´çš„å‘å¸ƒè¯´æ˜](https://github.com/unjs/nitro/releases/tag/v2.4.0)**ã€‚

### ğŸ’– ä¸°å¯Œçš„ JSON payload

**ä¸°å¯Œçš„ JSON payload åºåˆ—åŒ–** ç°åœ¨é»˜è®¤å¯ç”¨ ([#19205](https://github.com/nuxt/nuxt/pull/19205), [#20770](https://github.com/nuxt/nuxt/pull/20770))ã€‚è¿™æ—¢æ›´å¿«ï¼Œåˆå…è®¸åœ¨ä» Nuxt æœåŠ¡å™¨ä¼ é€’åˆ°å®¢æˆ·ç«¯çš„ payload ä¸­ï¼ˆä»¥åŠåœ¨ä¸ºé¢„æ¸²æŸ“ç«™ç‚¹æå– payload æ•°æ®æ—¶ï¼‰åºåˆ—åŒ–å¤æ‚çš„å¯¹è±¡ã€‚

è¿™æ„å‘³ç€ç°åœ¨å„ç§ä¸°å¯Œçš„ JS ç±»å‹éƒ½å¼€ç®±å³ç”¨ï¼šæ­£åˆ™è¡¨è¾¾å¼ã€æ—¥æœŸã€Map å’Œ Set ä»¥åŠ BigIntï¼Œä»¥åŠ NuxtError - ä»¥åŠ Vue ç‰¹å®šçš„å¯¹è±¡ï¼Œå¦‚ `ref`ã€`reactive`ã€`shallowRef` å’Œ `shallowReactive`ã€‚

æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„æµ‹è¯•å¥—ä»¶ä¸­æ‰¾åˆ° [ä¸€ä¸ªç¤ºä¾‹](https://github.com/nuxt/nuxt/blob/main/test/fixtures/basic/pages/json-payload.vue)ã€‚

è¿™ä¸€åˆ‡éƒ½å½’åŠŸäº [Rich-Harris/devalue#58](https://github.com/Rich-Harris/devalue/pull/58)ã€‚é•¿æœŸä»¥æ¥ï¼Œç”±äºåºåˆ—åŒ– Errors å’Œå…¶ä»–é POJO å¯¹è±¡çš„é—®é¢˜ï¼ŒNuxt ä¸€ç›´ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„ devalue åˆ†æ”¯ï¼Œä½†æˆ‘ä»¬ç°åœ¨å·²åˆ‡æ¢å›åŸå§‹ç‰ˆæœ¬ã€‚

æ‚¨ç”šè‡³å¯ä»¥ä½¿ç”¨æ–°çš„å¯¹è±¡è¯­æ³• Nuxt æ’ä»¶æ³¨å†Œè‡ªå·±çš„è‡ªå®šä¹‰ç±»å‹ï¼š

```ts [plugins/custom-payload-type.ts]
export default definePayloadPlugin(() => {
  definePayloadReducer('BlinkingText', data => data === '<original-blink>' && '_')
  definePayloadReviver('BlinkingText', () => '<revivified-blink>')
})
```

æ‚¨å¯ä»¥åœ¨ [æ­¤å¤„](https://github.com/rich-harris/devalue#custom-types) é˜…è¯»æ›´å¤šå…³äºå…¶å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚

## ğŸ› äº¤äº’å¼æœåŠ¡å™¨ç»„ä»¶

æ­¤åŠŸèƒ½åº”è¢«è§†ä¸ºé«˜åº¦å®éªŒæ€§çš„ï¼Œä½†å¾—ç›Šäº @huang-julien çš„å‡ºè‰²å·¥ä½œï¼Œæˆ‘ä»¬ç°åœ¨é€šè¿‡æ’æ§½æ”¯æŒæœåŠ¡å™¨ç»„ä»¶ä¸­çš„äº¤äº’å¼å†…å®¹ ([#20284](https://github.com/nuxt/nuxt/pull/20284))ã€‚

æ‚¨å¯ä»¥åœ¨ [#19772](https://github.com/nuxt/nuxt/issues/19772) æŸ¥çœ‹æœåŠ¡å™¨ç»„ä»¶çš„è·¯çº¿å›¾ã€‚

## â° ç¯å¢ƒé…ç½®

æ‚¨ç°åœ¨å¯ä»¥åœ¨ `nuxt.config` ä¸­ä¸ºæ¯ä¸ªç¯å¢ƒé…ç½®å®Œå…¨ç±»å‹åŒ–çš„è¦†ç›–ï¼š

```js
export default defineNuxtConfig({
  $production: {
    routeRules: {
      '/**': { isr: true }
    }
  },
  $development: {
    //
  }
})
```

å¦‚æœæ‚¨æ˜¯ç¼–å†™ layers çš„ä½œè€…ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ `$meta` é”®æ¥æä¾›æ‚¨æˆ–æ‚¨çš„ layer çš„ä½¿ç”¨è€…å¯èƒ½ä¼šä½¿ç”¨çš„å…ƒæ•°æ®ã€‚

é˜…è¯»æ›´å¤š [å…³äºæ¯ä¸ªç¯å¢ƒçš„è¦†ç›–](https://github.com/nuxt/nuxt/pull/20329)ã€‚

## ğŸ’ª å®Œå…¨ç±»å‹åŒ–çš„é¡µé¢

å€ŸåŠ©æ­¤ä¸ [unplugin-vue-router](https://github.com/posva/unplugin-vue-router) çš„å®éªŒæ€§é›†æˆï¼ˆæ„Ÿè°¢ [@posva](https://github.com/posva) çš„å‡ºè‰²å·¥ä½œï¼ï¼‰ï¼Œæ‚¨å¯ä»¥åœ¨æ‚¨çš„ Nuxt åº”ç”¨ç¨‹åºä¸­å—ç›Šäºå®Œå…¨ç±»å‹åŒ–çš„è·¯ç”±ã€‚

å¼€ç®±å³ç”¨ï¼Œè¿™å°†å¯ç”¨ [`navigateTo`](/docs/api/utils/navigate-to)ã€[`<NuxtLink>`](/docs/api/components/nuxt-link)ã€`router.push()` ç­‰çš„ç±»å‹åŒ–ä½¿ç”¨ã€‚

æ‚¨ç”šè‡³å¯ä»¥é€šè¿‡ä½¿ç”¨ `const route = useRoute('route-name'){lang=ts}` åœ¨é¡µé¢ä¸­è·å–ç±»å‹åŒ–çš„å‚æ•°ã€‚

ç›´æ¥åœ¨æ‚¨çš„ `nuxt.config` ä¸­å¯ç”¨æ­¤åŠŸèƒ½ï¼š

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  experimental: {
    typedPages: true
  }
})
```

## ğŸ” â€œBundlerâ€ æ¨¡å—è§£æ

æˆ‘ä»¬ç°åœ¨åœ¨ Nuxt ä¸­å®Œå…¨æ”¯æŒ [æ¨¡å—è§£æ](https://www.typescriptlang.org/docs/handbook/module-resolution.html) çš„ `bundler` ç­–ç•¥ã€‚

å¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬å»ºè®®é‡‡ç”¨æ­¤ç­–ç•¥ã€‚å®ƒå…·æœ‰å­è·¯å¾„å¯¼å‡ºçš„ç±»å‹æ”¯æŒï¼Œä¾‹å¦‚ï¼Œä½†æ¯” `Node16` è§£ææ›´å‡†ç¡®åœ°åŒ¹é… Vite å’Œ Nuxt ç­‰æ„å»ºå·¥å…·çš„è¡Œä¸ºã€‚

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  typescript: {
    tsConfig: {
      compilerOptions: {
        moduleResolution: 'bundler'
      }
    }
  }
})
```

è¿™å¼€å¯äº† TypeScript çš„ â€œè·Ÿè¸ªâ€ Node å­è·¯å¾„å¯¼å‡ºçš„èƒ½åŠ›ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªåº“æœ‰ä¸€ä¸ªåƒ `mylib/path` è¿™æ ·çš„å­è·¯å¾„å¯¼å‡ºæ˜ å°„åˆ° `mylib/dist/path.mjs`ï¼Œé‚£ä¹ˆå®ƒçš„ç±»å‹å¯ä»¥ä» `mylib/dist/path.d.ts` ä¸­æ‹‰å–ï¼Œè€Œä¸éœ€è¦åº“ä½œè€…åˆ›å»º `mylib/path.d.ts`ã€‚


## âš—ï¸ åˆ†ç¦»çš„æœåŠ¡å™¨ç±»å‹

æˆ‘ä»¬è®¡åˆ’æé«˜æ‚¨çš„ IDE ä¸­åº”ç”¨ç¨‹åºçš„ â€œnitroâ€ å’Œ â€œvueâ€ éƒ¨åˆ†ä¹‹é—´çš„æ¸…æ™°åº¦ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡ä¸ºæ‚¨ [`~/server`](/docs/guide/directory-structure/server) ç›®å½•ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„ `tsconfig.json` æ–‡ä»¶å®ç°äº†ç¬¬ä¸€éƒ¨åˆ† ([#20559](https://github.com/nuxt/nuxt/pull/20559))ã€‚

æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„é¢å¤–çš„ `~/server/tsconfig.json` æ–‡ä»¶æ¥ä½¿ç”¨å®ƒï¼š

```json
{
  "extends": "../.nuxt/tsconfig.server.json"
}
```

è™½ç„¶ç°åœ¨è¿™äº›å€¼åœ¨ç±»å‹æ£€æŸ¥ (`nuxi typecheck`) æ—¶ä¸ä¼šè¢«éµå®ˆï¼Œä½†æ‚¨åº”è¯¥åœ¨ IDE ä¸­è·å¾—æ›´å¥½çš„ç±»å‹æç¤ºã€‚

## ğŸ’€ å¼ƒç”¨

è™½ç„¶æˆ‘ä»¬æ²¡æœ‰å¯¹ Nuxt 2 ä¸­çš„ `build.extend` é’©å­è¿›è¡Œç±»å‹åŒ–æˆ–è®°å½•ï¼Œä½†æˆ‘ä»¬ä¸€ç›´åœ¨ webpack æ„å»ºå™¨ä¸­è°ƒç”¨å®ƒã€‚æˆ‘ä»¬ç°åœ¨æ˜ç¡®åœ°å¼ƒç”¨å®ƒï¼Œå¹¶å°†åœ¨æœªæ¥çš„æ¬¡è¦ç‰ˆæœ¬ä¸­åˆ é™¤å®ƒã€‚

## âœ… å‡çº§

ä¸å¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬å»ºè®®çš„å‡çº§æ–¹æ³•æ˜¯è¿è¡Œï¼š

```sh
npx nuxi upgrade --force
```

è¿™ä¹Ÿä¼šåˆ·æ–°æ‚¨çš„ lockfileï¼Œå¹¶ç¡®ä¿æ‚¨å¼•å…¥ Nuxt ä¾èµ–çš„å…¶ä»–ä¾èµ–é¡¹ï¼ˆå°¤å…¶æ˜¯åœ¨ unjs ç”Ÿæ€ç³»ç»Ÿä¸­ï¼‰çš„æ›´æ–°ã€‚

## ğŸ“ƒ å®Œæ•´æ›´æ–°æ—¥å¿—

é˜…è¯»å®Œæ•´çš„å‘å¸ƒè¯´æ˜: https://github.com/nuxt/nuxt/releases/tag/v3.5.0
